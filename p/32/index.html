<!DOCTYPE HTML>
<!-- Departed !-->
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="Stylesheet" type="text/css" href="/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/css/tango.css">
        <link rel="Stylesheet" type="text/css" href="/css/github-markdown.css">
        <title>涵曦 ~ 博客</title>
        <script src="/config.js"></script>
        <script src="/util.js"></script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139883805-2"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-139883805-2');
        </script>
    </head>

    <body>
        <div id="header">
            <div id="post-nav"><a href="/">首页</a><a href="/about.html">关于</a></div>
        </div>
        <div id="container">
            <div id="title">Docker 启动顺序控制</div>
            <div id="content" class="markdown-body">
                <p>使用 <a href="https://github.com/vishnubob/wait-for-it">wait-for-it</a> 脚本,监听某个容器的端口. 比如:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span>

<span class="pl-c"><span class="pl-c">#</span> ports: 2600</span>

<span class="pl-ent">services</span>:

    <span class="pl-ent">mongodb</span>:
        <span class="pl-ent">image</span>: <span class="pl-s">mongo:3.4-xenial</span>
        <span class="pl-ent">container_name</span>: <span class="pl-s">mongodb</span>
        <span class="pl-ent">restart</span>: <span class="pl-s">always</span>
        <span class="pl-ent">ports</span>:
            - <span class="pl-s"><span class="pl-pds">"</span>27017:27017<span class="pl-pds">"</span></span>
        <span class="pl-ent">volumes</span>:
            - <span class="pl-s">../data/mongo/db:/data/db</span>
    <span class="pl-ent">web</span>:
        <span class="pl-ent">image</span>: <span class="pl-s">xxx</span>
        <span class="pl-ent">command</span>: <span class="pl-s">["/wait-for-it.sh", "mongodb:27017",  "--", "/usr/bin/openresty", "-g", "daemon off;"]</span></pre></div>
            </div>
            <div id="comment">
                <a href="https://github.com/hanxi/blog/issues/32#new_comment_field"> 点击进入评论 ... </a>
            </div>
        </div>
        <div id="footer"></div>
    </body>
    <script type="text/javascript">
        setFooter();
    </script>
 
</html>
